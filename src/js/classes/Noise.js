import {Vec2} from "./Vectors.js";

class Noise2d{
	constructor(scale, depth, seed){
		this.facs = [];
		for(var i=0; i<depth; i++){
			this.facs.push(Math.pow(2, i));
		}
		this.pt = [116, 288, 250, 946, 258, 102, 105, 878, 276, 424, 228, 614, 193, 473, 261, 3, 233, 931, 8, 79, 32, 321, 803, 139, 773, 19, 72, 1011, 577, 525, 490, 515, 337, 91, 476, 706, 218, 49, 392, 236, 887, 737, 11, 726, 312, 458, 857, 1013, 672, 789, 376, 396, 280, 765, 363, 304, 556, 988, 378, 38, 688, 801, 394, 499, 945, 676, 781, 604, 426, 615, 656, 243, 238, 664, 873, 733, 169, 481, 409, 239, 978, 920, 991, 960, 74, 176, 690, 705, 893, 307, 108, 393, 779, 1015, 871, 568, 766, 738, 121, 554, 990, 576, 185, 244, 969, 983, 309, 437, 548, 723, 561, 759, 443, 505, 132, 230, 731, 520, 551, 720, 550, 387, 495, 92, 207, 532, 518, 667, 319, 428, 327, 826, 875, 896, 680, 657, 455, 252, 357, 492, 25, 885, 954, 338, 868, 59, 372, 98, 441, 827, 834, 529, 559, 429, 294, 763, 50, 84, 584, 905, 400, 768, 375, 924, 935, 812, 27, 82, 362, 536, 542, 425, 133, 77, 995, 940, 590, 558, 854, 985, 447, 785, 1003, 285, 93, 406, 769, 599, 912, 324, 41, 941, 632, 883, 145, 452, 890, 382, 415, 457, 634, 65, 510, 833, 575, 1009, 645, 673, 728, 353, 574, 109, 592, 895, 251, 633, 377, 654, 440, 774, 630, 299, 129, 1022, 736, 869, 506, 390, 369, 137, 939, 712, 821, 444, 164, 986, 232, 917, 655, 661, 171, 271, 856, 892, 66, 524, 68, 60, 981, 617, 190, 771, 876, 402, 952, 471, 263, 888, 1021, 311, 88, 843, 984, 807, 57, 450, 516, 1010, 825, 1023, 24, 331, 959, 94, 877, 354, 968, 107, 700, 922, 957, 366, 903, 221, 809, 329, 186, 565, 334, 208, 407, 472, 859, 982, 650, 413, 540, 423, 775, 671, 829, 758, 835, 713, 172, 788, 552, 866, 111, 840, 898, 930, 811, 643, 419, 762, 489, 687, 202, 42, 205, 813, 439, 212, 188, 339, 464, 1018, 521, 797, 162, 10, 519, 220, 442, 904, 81, 446, 926, 292, 136, 624, 541, 749, 796, 141, 463, 535, 13, 352, 226, 659, 12, 358, 20, 432, 953, 792, 537, 380, 652, 181, 242, 836, 557, 231, 842, 752, 907, 964, 223, 675, 122, 695, 118, 699, 627, 229, 404, 399, 1019, 35, 638, 161, 165, 603, 621, 989, 582, 927, 124, 943, 269, 741, 127, 601, 793, 772, 203, 356, 123, 175, 317, 666, 730, 933, 786, 113, 547, 620, 466, 882, 531, 901, 73, 365, 219, 853, 214, 302, 259, 925, 501, 608, 323, 281, 491, 37, 234, 480, 114, 715, 819, 266, 790, 757, 662, 810, 199, 87, 932, 1002, 805, 938, 709, 249, 886, 427, 594, 85, 289, 640, 889, 295, 967, 573, 367, 51, 753, 158, 848, 534, 52, 858, 126, 800, 336, 685, 434, 549, 678, 303, 58, 616, 595, 579, 913, 1008, 958, 341, 117, 746, 31, 408, 681, 310, 533, 578, 911, 351, 504, 381, 156, 837, 597, 100, 436, 21, 863, 583, 268, 591, 485, 543, 527, 498, 697, 272, 538, 322, 160, 782, 658, 320, 150, 966, 872, 646, 305, 493, 196, 359, 500, 562, 602, 908, 780, 192, 189, 222, 976, 54, 980, 783, 453, 373, 17, 647, 39, 147, 1005, 282, 45, 1004, 776, 494, 346, 760, 386, 152, 86, 528, 475, 101, 560, 735, 944, 609, 484, 881, 955, 644, 1020, 764, 916, 791, 784, 694, 287, 216, 201, 743, 333, 555, 197, 862, 631, 275, 947, 974, 245, 213, 563, 972, 138, 724, 417, 112, 502, 99, 262, 4, 225, 756, 330, 177, 607, 173, 418, 860, 48, 1014, 679, 747, 316, 241, 204, 651, 332, 997, 104, 684, 703, 823, 211, 347, 6, 140, 598, 125, 610, 397, 965, 668, 298, 325, 611, 461, 478, 977, 411, 0, 564, 722, 605, 891, 936, 198, 851, 349, 581, 906, 56, 497, 248, 704, 227, 975, 260, 589, 151, 625, 918, 483, 474, 979, 740, 267, 291, 942, 401, 880, 89, 482, 745, 585, 822, 326, 433, 921, 963, 544, 641, 142, 179, 619, 956, 707, 18, 398, 951, 838, 469, 477, 831, 96, 180, 22, 1007, 642, 572, 795, 660, 350, 588, 580, 637, 734, 914, 290, 75, 83, 274, 998, 224, 343, 438, 503, 247, 509, 629, 283, 1, 839, 692, 710, 264, 919, 286, 159, 648, 845, 487, 729, 277, 69, 64, 698, 751, 818, 817, 832, 814, 134, 130, 546, 884, 970, 470, 135, 279, 739, 235, 639, 748, 677, 1016, 167, 716, 361, 923, 344, 14, 395, 163, 170, 462, 33, 70, 696, 613, 454, 47, 422, 899, 586, 513, 841, 846, 727, 486, 355, 467, 915, 798, 937, 2, 154, 301, 459, 342, 669, 993, 23, 526, 384, 206, 44, 961, 308, 46, 97, 511, 148, 71, 850, 95, 237, 929, 844, 421, 183, 623, 210, 683, 34, 714, 496, 717, 313, 663, 155, 799, 168, 187, 900, 62, 864, 721, 296, 451, 612, 149, 636, 389, 992, 530, 693, 78, 674, 420, 80, 665, 830, 293, 106, 1001, 385, 870, 996, 847, 849, 512, 273, 948, 571, 435, 7, 405, 1012, 778, 55, 670, 802, 902, 153, 567, 949, 360, 987, 804, 318, 254, 806, 194, 348, 600, 465, 1006, 508, 815, 174, 414, 865, 255, 430, 514, 403, 374, 999, 90, 9, 742, 278, 682, 750, 828, 761, 5, 120, 28, 67, 653, 379, 994, 368, 539, 962, 345, 240, 256, 566, 754, 824, 76, 43, 701, 808, 626, 182, 391, 855, 479, 971, 131, 522, 622, 719, 410, 53, 777, 143, 315, 30, 787, 708, 460, 820, 300, 297, 128, 314, 950, 184, 468, 456, 253, 718, 388, 103, 29, 702, 689, 217, 593, 867, 144, 115, 488, 861, 628, 61, 816, 36, 284, 449, 445, 370, 371, 178, 909, 711, 26, 1000, 431, 910, 553, 523, 897, 596, 686, 755, 209, 166, 157, 934, 16, 569, 618, 383, 340, 328, 215, 587, 517, 270, 448, 635, 265, 852, 973, 195, 794, 874, 412, 725, 364, 306, 744, 767, 894, 110, 119, 879, 649, 63, 1017, 606, 416, 200, 15, 570, 507, 732, 146, 691, 928, 335, 246, 257, 40, 191, 770, 545];
		this.gradients = [[0.3662627597164452,0.9305114673365898],[-0.4535588913053398,-0.8912263080261213],[-0.36687735583957615,-0.9302693189459497],[0.9747162687943277,-0.22344617998002092],[-0.7804272430246004,0.625246606024392],[0.033100432327204596,-0.9994520305546195],[0.6375580709891188,-0.7704023014741285],[-0.6515310884694034,0.7586219353260717],[-0.0592276920174134,0.998244499357893],[-0.8803537506703835,0.47431769277625346],[-0.1616740251563684,-0.986844217488119],[0.9920097841107333,-0.12616096158707865],[-0.958192265883152,-0.2861251152934866],[0.8433474718923434,0.5373686273432727],[0.9820417649109221,0.1886636477190061],[0.886231113582755,-0.4632433629506958],[-0.6953712026478899,-0.7186507430790198],[0.8979618136551288,-0.440073381627646],[0.1284897802977795,0.9917108330350276],[0.9388297074085545,0.34438173657609633],[0.27666587960138433,-0.9609661758170224],[0.2004815269697406,-0.979697482564838],[-0.7462556668089828,0.6656594322590798],[-0.9180778309127043,-0.3964001720315265],[0.42839240072443846,-0.9035928015436777],[0.9513422702801253,0.3081361464973835],[-0.45376805210685883,0.8911198319458203],[-0.38218500795808674,0.9240858291804269],[0.066333092778853,-0.997797534975103],[0.02505268377048166,-0.9996861322614695],[0.8739669679390063,-0.485985327917932],[-0.9436524912710419,0.33093802398327726],[0.9379525695503271,0.34676357547173087],[-0.9821391563769695,0.1881559924932892],[0.34063650444350285,-0.9401950711636982],[0.661254694796627,-0.7501614683582594],[-0.9484251791535392,0.31700107183979237],[0.849138439673259,0.5281703420954863],[0.9755296483372308,0.21986792675385586],[-0.5737125872116612,0.8190566935657764],[-0.4886472968067249,-0.8724814148871485],[-0.31650491532338976,0.9485908699624586],[-0.7744199154687369,0.6326719485842519],[0.9442829830067847,-0.32913469583714244],[-0.839011842111385,-0.5441131580809826],[-0.9069575381085712,0.4212220602817945],[-0.8616530471527404,0.5074978091897513],[0.8772922153027495,-0.4799566323837959],[-0.34850402347695913,0.937307284523262],[-0.980975449279146,0.1941318312682841],[0.18092073260848995,-0.9834976809898472],[0.9803554411995737,0.1972389639761605],[-0.5775465658239679,-0.8163577428461992],[-0.5558456061365529,-0.8312855478947581],[-0.8951987063705285,-0.44566722575541984],[-0.872043833008607,0.48942778150781024],[-0.9990106285825129,0.04447205840943879],[0.49288548891132555,-0.8700941873272362],[0.6741771518846518,-0.7385696770628343],[-0.2098917836978356,-0.9777246233659767],[0.9492587779458174,0.31449606117217654],[0.7243540399964212,-0.6894281867902291],[-0.02680581911613234,0.9996406594679476],[0.8383913301814792,-0.5450687823353398],[-0.06653790956485658,0.9977838977407578],[-0.93105209149057,-0.3648862876719749],[-0.2792093361346601,-0.9602302570817285],[-0.37556410810647445,0.9267964181535168],[0.6164002921514607,0.7874329684713448],[0.9043550881567617,-0.42678082726966066],[0.1794285129874386,0.9837710143763724],[0.9659612399222172,0.2586868434380317],[-0.0812470513840374,-0.9966939934811484],[0.5889885846907521,0.8081413534178193],[0.9940317837859659,0.10909084665218571],[0.6937078293627206,0.7202565150561725],[-0.9517404421331567,-0.3069041068610577],[-0.5789635987257127,0.815353390469784],[0.5178374009532506,-0.855479062381998],[0.6865206502916936,-0.7271103057467072],[-0.9591082561835468,-0.2830394900372666],[0.44346588662433,-0.8962912514358805],[0.6852245805283127,-0.7283318434888028],[-0.9728066558127308,-0.23161867456328064],[0.16583857827391688,0.9861529120557754],[-0.6713461894744315,0.7411439090204821],[0.8472663801478837,0.5311682229492855],[0.38459173910465255,0.9230867750176355],[0.9209412041080843,0.3897015506460703],[0.9843897606791499,0.17600227007071848],[-0.8493690829289364,-0.5277993567298633],[-0.9999501094422326,0.009988925190779763],[0.8382325709428896,0.5453128982616068],[-0.0911712315639795,0.9958352306155408],[-0.24017452050145452,0.970729725362264],[0.15961686308376694,0.9871790400020141],[0.6552339858930695,-0.75542598825476],[0.412855612378681,0.9107964884250621],[0.6429226561935653,-0.7659311053567486],[0.6644909944307402,-0.7472962721173216],[-0.8276095873995629,-0.5613041696302685],[0.8753827930829539,-0.4834304144075819],[0.4992416703901955,0.8664627831280507],[-0.16890532287189117,-0.985632280267617],[-0.9997994886858235,0.020024545527075742],[0.8138008538675994,-0.5811438464307837],[-0.3881528360910077,0.9215950172578556],[0.8812612374351814,-0.47262948637829716],[0.9166242994915335,-0.3997497887199636],[-0.7173236830824959,-0.6967400761323859],[-0.5975878725584861,0.8018034263901737],[-0.12074737938961218,-0.9926832679009661],[-0.11926400058726729,-0.9928625776832967],[0.9904086252237292,-0.13816929862470442],[-0.979133209817533,0.2032194809372735],[-0.10146296521121537,0.9948393170208683],[0.9721679202011894,0.23428515730129804],[-0.07131469258544389,-0.997453865911323],[-0.6237349970532399,-0.7816358829090402],[0.8835678174627827,-0.46830322649332096],[0.06970718560504348,0.9975674955986807],[-0.4347075199601766,0.9005716918103037],[0.9167295638209912,0.3995083313481399],[0.5549842638856552,-0.8318608458385919],[0.3719133277428717,0.9282674596511629],[-0.9196557615423363,0.3927254515077746],[0.9966172464186223,-0.08218311347815478],[0.5390956880416897,-0.8422445245502383],[0.32342574126533424,-0.9462535547552617],[-0.7550320184860451,0.6556879220032107],[-0.4417803613415922,0.8971232425552758],[0.2204959395046734,-0.9753878924109892],[-0.4567815249048129,-0.8895789107806198],[0.2637860599662259,-0.9645812120124955],[-0.8242867417761113,-0.5661725596778091],[0.9914929998037445,-0.13016002205044322],[0.21662922989281186,-0.9762539509554096],[0.060567648149063014,-0.9981640947247559],[-0.5212468520186592,0.8534059522060049],[0.22597206069216277,-0.9741337833103508],[-0.42481498076430363,-0.9052801953639682],[-0.9963576422005218,0.08527279066980856],[-0.9770677756682375,0.21292853672235337],[-0.9999996049044488,0.0008889268508878649],[0.9768366413370477,-0.21398639242100417],[0.6189095143286353,-0.7854622925853875],[-0.9761877076976624,-0.21692754398642705],[-0.25267576671098574,-0.9675510099819107],[-0.028257089709374843,-0.9996006887158273],[-0.051971660182251356,0.9986485600740135],[-0.037006316961546985,-0.9993150316616585],[0.8175849671160856,0.5758079728049874],[0.6255923776543443,0.7801500990327337],[-0.390424865072018,-0.9206347944399541],[-0.21915532829305828,-0.9756899825665741],[0.20223629940909058,-0.9793367547484965],[0.32499293373984334,0.9457164442998598],[0.8331516584517481,0.5530445859233247],[0.8344400421975363,0.5510987352347798],[-0.1910791592184192,0.9815746303324989],[-0.08359179902402074,0.9965000808509389],[0.419929475518218,0.9075567395986844],[0.8738404869546825,-0.4862127141064941],[0.3100589038665129,0.9507173481814122],[0.49880282318239993,-0.8667154917187458],[-0.729584761809197,0.6838903971659621],[-0.3849237853211995,-0.9229483623117813],[0.9842706182344031,-0.17666734299373477],[-0.8903384217318713,-0.45529934635138736],[0.9756842987627337,-0.21918063132465138],[0.9328091926403499,-0.3603706565824395],[0.43669050163717366,-0.899611808381745],[0.9083565582611964,0.4181965603204714],[0.9915825114796878,-0.1294763411887856],[-0.9932599408050036,-0.11590811012194471],[-0.911550969565588,-0.4111870983920051],[-0.8053831961771807,0.5927545084733047],[-0.940784372192119,-0.33900555310950364],[-0.9542904306709901,0.29888086912644035],[0.69688729283351,0.7171806614007252],[-0.032112816691669155,0.9994842505032919],[0.6684618565408431,0.7437464261090397],[-0.2772536386617014,-0.9607967630299588],[-0.8707738449803981,0.4916837508989428],[0.9548245119263326,-0.297170239803115],[0.7942489526618998,0.6075924630831717],[0.7675300184574133,0.6410130035863256],[-0.5019747969347935,0.8648822481946735],[-0.865886074398311,-0.5002412479625032],[-0.8384029146936236,0.5450509633357569],[-0.8089686328300586,0.5878518104905912],[0.20740632640521553,-0.9782548828230264],[0.5511794820800605,-0.8343867080280919],[0.8908505234893729,-0.4542965383961342],[-0.5976837864738318,-0.8017319323728493],[-0.5003740350089116,-0.8658093468477344],[0.7079947797487343,-0.7062176660552618],[0.9724031830245362,-0.23330677153428359],[0.7754476555181286,0.6314118573098211],[-0.8861355098720388,0.4634262165046576],[0.9427496292176859,0.3335013292475994],[-0.9418378852478824,0.3360675496262569],[-0.2409059762199434,0.9705484586673229],[0.9450175890823501,0.3270195045023804],[-0.2846978530598179,-0.9586173024012922],[0.9837469902556606,-0.179560182565426],[-0.9682379635920506,-0.2500304898589749],[0.7210886812261289,-0.6928427771201503],[-0.1645961272554488,0.9863610469257735],[-0.9658826614791217,-0.25898008466677197],[-0.6680747846320604,0.7440941352670549],[0.884663554525291,0.46622998111948727],[0.2738460609732458,0.9617735361764937],[-0.38412904408700316,-0.9232794146350308],[0.6108899554152962,-0.7917155185877673],[0.5706949036277439,-0.8211621806764606],[0.17478116687417233,0.9846073043127919],[0.8511933796822289,0.5248521986094228],[-0.959449695569744,-0.2818799064692718],[-0.9928511429732033,-0.11935915506069836],[0.6989694990850427,0.7151514800018277],[0.9879492771524493,0.15477798866102693],[-0.7787897364682516,0.6272850598983777],[-0.864934829057902,0.5018841913057015],[-0.9323598339874234,0.3615316583190803],[0.293800637077936,0.955866719607184],[-0.9853369326255526,-0.17061983824886023],[0.14267552207304504,0.9897695163022471],[-0.7346693235139892,-0.678425371789335],[-0.9401890888169908,-0.34065301594067315],[0.4582567507536805,0.8888198638580705],[0.3418919676043174,0.9397392630339803],[-0.8536070802888222,0.5209174142614089],[0.3062916371311246,-0.9519377253914961],[0.4431499537328396,0.8964474990241103],[-0.8724638689729911,-0.4886786237770989],[0.9944047489619399,0.1056370921690929],[0.9988139148597264,-0.048690486571684184],[-0.06681913583507852,-0.9977651041634265],[0.6463079802040116,0.7630766637269226],[-0.9098791173272195,-0.41487346486831367],[-0.8932233314298609,-0.44961325624289694],[0.37932337174069514,0.9252641674955702],[0.8307696553733099,0.5566163667292867],[-0.8274573258891638,-0.5615286046430353],[-0.6921600132384791,-0.7217440793478728],[0.37766444128326515,0.9259425305007861],[-0.784606151191717,0.6199945060338201],[0.20173364991923318,-0.9794404190609372],[0.1707085071082399,0.9853215747160294],[0.3600159254715729,-0.9329461578284391],[-0.8887806852839035,-0.4583327322658451],[-0.5413514310729033,0.8407964248706815],[-0.17177897477011833,0.985135515463191],[-0.6646315430979272,0.7471712734837095],[0.9628224046989674,-0.270135182843142],[0.34477633356009185,0.9386848671502381],[0.8694909044409649,-0.49394895191146304],[0.9834519935432379,0.18116891674851768],[0.0933315077291999,0.9956350886067618],[-0.7399120862291172,0.6727035785931835],[0.2737953224005047,-0.9617879815383449],[0.5826816598733526,0.8127004880318669],[-0.547478238233008,0.8368199200911041],[-0.9334343855660725,0.35874816772060125],[0.6488696644977016,0.7608995718849106],[-0.9991550539664743,0.041099612324836686],[-0.5523555263194475,0.833608644715472],[-0.3211230994752129,-0.9470374622914516],[-0.14207773463441972,0.9898555032534554],[0.7207936043622519,-0.6931497528748557],[-0.6619924354506467,0.7495105172084788],[-0.6901327661426291,-0.7236827793282934],[-0.5517551144921158,0.8340061712192496],[0.8711038537837114,0.4910988453694087],[-0.47547455690180673,0.8797294730421567],[-0.9901098703951509,0.14029413582219888],[-0.9874386080805542,0.15800314956334804],[0.9927297243925627,-0.12036483833523222],[0.9880916392979362,-0.15386654070822928],[0.3421526534781819,0.9396443804534985],[0.8087524178002046,0.5881492384610587],[0.9316954635559282,-0.3632403655835954],[-0.876960759575592,0.4805619899290836],[0.26632477429978796,0.9638833511344446],[0.2778418497339495,0.9606268300107058],[0.7968927216548161,-0.6041208407045563],[-0.03249498239246333,0.9994718986141199],[0.3259902644308746,-0.9453731260704888],[0.9749240568671226,0.22253782451923002],[0.9753693373228638,-0.2205780039132584],[0.9114582438193685,0.411392598102728],[0.8996068592745592,0.43670069698383074],[0.6347007511691439,0.7727580193471463],[0.9721431730608021,0.23438782193466326],[0.41463043701057417,0.9099898904407786],[-0.42709509314321104,-0.9042067138729903],[-0.9069098563753841,0.421324711367824],[0.5186154436439891,0.8550076149450064],[0.22468491961634865,-0.9744314685481965],[-0.999189782077155,-0.04024648298432477],[0.9874634306788741,0.15784794288145948],[-0.4644658509785588,0.885591030484593],[0.5598334947772879,-0.8286051279864542],[-0.6843767998485071,-0.7291285180467957],[0.3610956422806612,-0.9325287862183755],[-0.8178600051550555,-0.5754172503216883],[-0.4729056264402227,-0.8811130849562845],[-0.7725232082422956,0.6349865295634474],[0.6681087901173819,0.744063602501754],[-0.5433730209068032,-0.8394913699083599],[-0.6938358621249994,0.720133179647528],[0.9179270317120051,0.39674924631609265],[0.16845165495334224,-0.9857099167318345],[-0.9197596240290195,0.3924821448244453],[-0.9778545482312988,-0.2092856481065113],[-0.0326219374223428,-0.9994677629612737],[-0.9982141164824588,-0.05973757322777769],[-0.9958638912001686,-0.0908576370133994],[0.3539632262755866,0.9352593407416886],[-0.9822266115896174,0.18769891711242975],[-0.10686790832661558,-0.9942732271211441],[-0.9891360805165028,0.14700276943122714],[0.9001470689670846,-0.4355861042663856],[-0.8654277893757548,-0.5010336728965371],[0.3140266280636064,0.9494141756193666],[-0.9373916093206969,0.3482771465013948],[-0.8463866085451783,-0.5325689710031848],[-0.6697596571759878,0.7425779431275233],[-0.9001604333140352,-0.43555848550555004],[-0.9261473983367867,0.3771617644380212],[-0.6936764043407129,-0.7202867804291149],[0.40757415750444903,-0.9131721119999989],[0.2696607375009374,-0.9629553918279136],[-0.21843108575182238,0.9758523765289912],[0.8762683552274576,-0.4818233801165798],[-0.9999126564627463,-0.01321663518501732],[0.9958004515110533,0.09155031824293332],[0.8632295440284332,0.5048116027950063],[0.377480218287566,-0.9260176482128035],[-0.40081600860629363,0.9161585710153671],[-0.723353877467451,0.6904774927199322],[-0.963178551285398,0.26886256404297326],[0.5887645173711205,-0.8083046103324858],[-0.6482733057513088,-0.7614077232667593],[-0.9986751446051406,-0.05145828939929353],[-0.7393893045215276,0.6732781418991498],[0.9728504621641808,0.23143460905175736],[0.9106675656882707,0.41313990947789003],[0.993926696823847,0.11004417904113038],[-0.9742340146167,-0.22553954146408034],[-0.5894896033735852,0.8077759636894708],[-0.8957327666605842,0.44459285951370775],[-0.14482992137922585,0.9894565649250538],[-0.9207114541168622,-0.39024404961256376],[0.539415960798288,-0.8420394416154505],[-0.3920782774514104,-0.9199318585366717],[-0.03203507468722381,0.9994867452796881],[-0.3806593748017581,0.9247153293719829],[0.9936952818443097,-0.11211461474918447],[0.8913735477045422,0.45326945457709605],[0.37411433246647624,0.9273825889260392],[0.6519294574438519,0.7582796202700987],[0.00868251793284196,0.9999623062307628],[0.6775274321245004,0.7354975042233525],[-0.8709882717716029,0.4913038066576692],[0.05380735249793459,-0.998551335093576],[-0.9449061024928271,-0.32734149977021676],[0.41764192393056015,0.9086117010998593],[-0.760051672910954,0.6498626427986611],[-0.6663703705483565,-0.7456209018363461],[0.039235831235210024,-0.9992299783069372],[0.007238325552297861,0.9999738029784575],[-0.6688909202655487,0.7433605698355995],[-0.820632933271873,-0.5714556752973948],[-0.7616793765068005,0.6479541090264123],[0.21068990956662717,0.9775529458841636],[0.9679803979863396,0.2510257937228914],[-0.3097846657445728,0.950806742124562],[-0.6297868239753662,-0.7767680196474499],[-0.9930525331587702,-0.11767185894235566],[0.8310682577987811,0.5561704333019679],[0.9996362602594449,-0.026969374751957275],[-0.13493538851908488,-0.9908543994579646],[0.3277438387836141,0.9447666252251824],[0.709798545788491,-0.7044047305324855],[0.1215756950842331,-0.9925821630297341],[-0.9756720183168679,-0.21923529066619127],[-0.9874942124533349,-0.1576552579876991],[0.8268122639497062,0.5624779819533929],[-0.7011434085311319,0.7130202806886676],[-0.3431312791399451,0.9392874561473634],[-0.9966359821248746,0.0819555924509524],[-0.18617121346265056,-0.9825173175460289],[-0.1900160992670076,0.9817809745657892],[0.30182811449879493,-0.9533623599125898],[-0.08936423662809373,0.9959990126560759],[-0.606166885626204,0.7953374797972421],[-0.7950528618318977,-0.6065401445023317],[-0.9360974091495035,-0.3517408713578608],[0.9031379720625966,0.4293504435990028],[-0.543649790076633,0.8393121622791087],[0.7827430797522494,-0.6223449775646652],[-0.09082607846921467,-0.9958667699395859],[-0.8548058590817678,-0.5189479196214982],[0.6258576081473827,-0.779937339998565],[0.06104696997387159,0.9981348944190906],[0.9246633480880166,0.3807856256513097],[-0.9749516008548609,0.22241712162183916],[0.42564431703204053,-0.9048905543646302],[-0.9049718179546623,0.4254715133917118],[-0.26672445685737395,-0.9637728280638227],[0.3864732439035787,0.9223006189668557],[-0.9008667973883195,0.4340956269801764],[0.6812745221760973,0.732028022300875],[-0.6425938010844147,0.7662070260757753],[-0.9926285877804115,0.12119606726732454],[0.14783998699011597,-0.9890112932857553],[-0.9914297202142122,0.13064114924467304],[-0.34314141770610784,-0.9392837523638118],[-0.9848197610974393,0.1735800626569265],[-0.4115005717735006,-0.9114095015030741],[0.9741056781270642,-0.226093183976458],[-0.8672612834268052,-0.4978532577666744],[0.7935279946437519,0.6085337473934093],[0.167011216350752,0.9859549957341067],[-0.9583373655684608,0.2856387469432366],[0.10271603613259296,-0.9947107197176513],[0.817755175031804,-0.5755662200900117],[-0.6916720276656957,-0.7222117460584707],[0.9968764491444353,0.07897686459452555],[0.9800795611567883,0.1986052713366827],[0.9887855642944624,0.14934225069578155],[-0.8274741918282336,-0.5615037505290696],[-0.9999748071243066,-0.007098247439033377],[0.9070600231098521,-0.421001323603566],[-0.7174925724893734,-0.6965661550941025],[-0.7063635454948198,-0.7078492364875358],[0.6226032160476882,0.7825376894227367],[-0.43127016250595096,-0.9022228366274546],[-0.8044226898162611,-0.5940573508582917],[-0.17559210371277037,-0.984463007488714],[0.9730264328255782,0.2306936518908367],[-0.480742555346384,0.8768617881279973],[0.4599327924712422,0.8879537298810143],[-0.3445627064910194,0.9387633041909892],[0.35178109359167065,-0.9360822945614602],[0.778680783363499,-0.6274203037999388],[-0.908371776047656,0.41816350448123424],[-0.16818095908186229,0.9857561387089127],[-0.9997365893452359,-0.022951076758077248],[0.3486793374831256,0.9372420816482413],[-0.9036739623665296,-0.42822116918804465],[-0.4420084473529579,-0.8970108875975963],[-0.95629868112726,-0.2923915738769896],[-0.7186712966202865,-0.6953499603898142],[0.5168940436448055,0.8560493838818657],[0.8991803297159677,0.4375782611737967],[0.9997899872189373,-0.020493449118125513],[0.9368851382152267,-0.34963729462320753],[0.6882340036946457,-0.7254887705253875],[0.9609038499220384,-0.2768822695750032],[-0.9626801186637228,0.2706418096481041],[-0.40733906757897764,-0.9132770028988407],[0.9708820413541475,-0.23955805512652575],[0.9712990874079418,-0.2378614781768991],[-0.01439443104344716,-0.9998963948104501],[0.15364009736433126,0.9881268746886094],[0.38639296789239874,-0.9223342530575906],[0.1341186190090907,0.9909652849797991],[0.9845150493290404,0.17530007884948895],[-0.9576885656827068,0.287806551629041],[0.0010182470848336784,-0.9999994815863027],[0.8963802129103786,0.44328604072623834],[0.5256088028541378,-0.8507263874843898],[0.025785149296649507,0.9996675077623307],[0.6374280725788277,-0.7705098651467356],[0.7643208824173129,0.6448360944463486],[0.05741423874491695,0.9983504420739953],[0.7041025784334833,-0.7100982742151402],[-0.18932049281273988,0.9819153481849345],[-0.2713629348457779,-0.9624770945803781],[0.7294367284947777,0.6840482871280623],[-0.7126615229261398,0.7015080567895104],[-0.793630575626117,0.6083999584412856],[0.2998577368808358,-0.9539839294415308],[0.39161304414609815,-0.9201300036704738],[-0.11902394042333253,0.9928913845965746],[-0.6549281660703544,-0.755691138817786],[0.15681557688562564,0.9876279030313129],[0.5871653056052831,-0.8094670492944444],[0.8320425055405783,-0.5547118792434111],[-0.4053475356508598,0.9141626635023851],[0.9954883645323391,-0.09488369765522806],[-0.4959085420274904,0.868374756625369],[-0.6192131118968492,-0.7852229760106488],[-0.7384217138139181,-0.6743392117978281],[0.0701576819002278,-0.9975359139752245],[-0.32757287013476805,0.9448259176968371],[0.9835650858802392,-0.18055393055095106],[-0.9999616144907097,-0.008761823162632533],[-0.9988469097840552,-0.04800886183657594],[0.8921989566964068,0.4516425817721833],[-0.4847464327610531,0.8746547295507147],[-0.9084089750811741,-0.4180826879840528],[0.9564943482595994,-0.29175085560704717],[-0.9405230765276226,0.3397298081108218],[-0.9410782923796036,0.3381887751121986],[-0.10030119265966142,-0.9949571200564623],[0.8733573739325978,-0.48707997022825367],[-0.9978546720685239,0.06546795728460475],[-0.8170281520011865,-0.5765977790778648],[-0.1805496052094239,0.9835658798772562],[0.6817120622673161,0.7316205739037435],[0.7099571958251599,0.7042448296551956],[0.7369660018643819,0.6759298129954233],[0.8055316616894173,-0.5925527335316969],[0.8537830439086757,0.5206289599455992],[0.2892652651773787,-0.9572489782506225],[0.821971774601527,0.5695282273587643],[-0.18716506796332014,0.9823284773100522],[0.3153851657722515,0.9489637491552612],[-0.7557288511397199,0.654884649045188],[-0.09819628114398428,-0.9951670665619374],[0.019441570349478254,-0.9998109948096922],[0.42528981281596484,-0.9050572220113828],[-0.6660353452510527,-0.7459201826444375],[-0.937050125278699,-0.3491948778478493],[0.3489119371808322,-0.9371555154256518],[-0.19067863557206471,-0.9816525138440668],[-0.5725942242267374,0.8198389197776479],[0.030294018146732823,0.999541030905948],[0.47869524080674053,-0.8779811310210355],[0.6126656138533164,-0.7903422332140293],[0.8973809859085434,-0.44125657630205417],[0.17921879003671692,-0.9838092423319549],[-0.7523481106902211,0.6587657552885204],[0.9750407425725462,0.22202601271827954],[0.9281299626405317,-0.37225632627113964],[0.807934645570684,-0.5892721005499695],[-0.3134609758507856,-0.9496010828862156],[-0.8989715694282995,0.4380069832315693],[-0.8114708448770193,-0.5843929054279975],[0.8791144779455616,0.47661067410046803],[-0.5377191340806858,-0.8431240317079791],[-0.7403382116584364,-0.6722345813467113],[-0.17883338617992633,-0.9838793726811338],[-0.9349456388436519,0.3547909982049087],[-0.9252881818745632,0.37926478940611574],[0.29841115986490174,-0.954437415270422],[-0.35087665343962077,0.9364216860319993],[0.5144117817161636,-0.8575433043477175],[-0.933485809662919,-0.3586143376358012],[0.21930134725541378,0.9756571729311277],[-0.5241790734456261,-0.8516080665198544],[-0.01930210972173159,0.9998136969257274],[0.9359902437164178,0.352025941753844],[0.9930386560659643,-0.11778891101756306],[0.953631848733597,-0.3009755755554627],[0.07221883436015421,-0.9973888108273827],[-0.8821111919234391,0.47104123501388884],[-0.848106269101414,0.5298261566880971],[0.9173535227956507,-0.3980735035322114],[-0.9631573384517619,0.26893854574329484],[0.26824790791326364,-0.9633499156070743],[-0.9999716903730924,-0.007524523398869695],[-0.9951717188411275,0.09814912133481245],[-0.7849861810632558,0.6195132730940681],[0.6431337946163956,0.7657538261231973],[0.5214099724161899,-0.8533062994405631],[0.7388746200162938,-0.6738429311759362],[0.6164730092297103,-0.7873760403335026],[0.9135940772737822,0.40662742402630264],[0.9879879484715703,0.15453094730486097],[-0.08495631449233329,0.9963846770338651],[0.3717958266265637,-0.9283145282193263],[0.810771321586168,0.5853630190688668],[-0.6127853886577298,0.7902493704189805],[0.5363364926736318,0.8440042456211623],[0.7007830524094092,0.7133744552868089],[-0.8648921027059764,0.5019578176269743],[-0.41370777149805116,0.910409731825246],[-0.8009320053501746,0.5987553112964827],[-0.13431625371669587,-0.9909385167544514],[0.6552862274924751,-0.7553806722829756],[-0.7582327491160468,0.6519839707906339],[-0.544988522843952,-0.8384435043390623],[-0.7151040917064672,0.699017981188373],[-0.966596948020936,0.25630126819157967],[-0.8915134258715529,-0.4529942731324174],[0.19133489655641503,-0.9815248124014726],[-0.5726475648314034,0.8198016628994257],[0.6309239677110575,-0.7758446667779166],[0.7677265161947359,0.6407776496816145],[-0.9349762946061559,0.35471020358109606],[-0.5184259610605396,-0.8551225192324523],[0.941694972499545,0.3364677975216664],[-0.9672334168218949,0.2538887894000886],[-0.9032567997797334,0.42910040043289943],[0.8417417250741234,-0.5398804203425412],[0.081149129183097,0.9967019709185013],[0.9992349418334173,0.039109219107100225],[-0.2405473854582213,-0.9706373964304147],[-0.6018662808063177,-0.7985968820552525],[0.959848205122615,-0.28051991573308016],[-0.8977083858969125,0.44059012005531856],[-0.36187440459200654,0.9322268582813846],[0.8080757048081302,-0.5890786495017823],[0.23744754368845108,0.9714003623616377],[-0.8330359215501714,-0.5532189018888063],[0.9490157997966925,0.3152285071757376],[0.945410556086206,-0.32588169700179653],[-0.5520689743170557,-0.8337984454270193],[-0.8802639349278385,-0.47448435681838663],[0.9004555278766495,0.43494809151941866],[0.9719774934952031,0.23507392909206742],[-0.5306181261962615,-0.8476109981306096],[-0.6523223924705935,-0.7579416179900935],[-0.8619128625428553,0.5070564242598462],[0.817273923220122,0.5762493682637665],[-0.6358318181014927,-0.7718276356089813],[-0.9998792135199035,-0.0155421482047753],[0.9999187388314982,-0.012748165892638653],[0.5630745648196349,-0.8264060953630356],[-0.027660293582914514,-0.9996173808807582],[0.7869119619970074,0.6170652834717087],[-0.9394654033142973,-0.3426437741671441],[-0.7414653409815899,0.6709911684389405],[0.3428414725351462,-0.9393932747842794],[-0.3444352012158539,0.938810093769445],[0.7782435433848313,-0.6279625682951352],[-0.6302857882966731,-0.7763632043517011],[0.32518832571386835,0.9456492757991258],[0.2758750148053877,-0.9611935165231438],[0.974171839417414,-0.22580794336358517],[-0.3206545708305534,0.9471962025924057],[-0.687572169852756,-0.7261160453012816],[0.7941939030152865,-0.6076644175968722],[0.6359291729430475,0.7717474243559038],[-0.3271881972708887,0.9449591967733982],[0.6171829908911505,-0.78681964626886],[-0.07087088778162612,0.9974854972705338],[0.8964205859964899,-0.4432043919025506],[0.8095572194945663,-0.5870409767335042],[-0.9468430328874157,-0.32169592952438847],[-0.9945999834889458,0.10378281574417152],[0.7672867985775432,-0.641304115633624],[-0.8060808163275678,0.5918054727262008],[0.7505913793907089,-0.6607666616774435],[0.9420824040927648,-0.3353814900956769],[-0.8451430522103847,-0.5345401961504065],[0.9035227314221855,0.42854016591609373],[0.040957377812335896,-0.9991608945523927],[-0.07392446717290842,-0.997263843299857],[0.5452138020188497,0.8382970297502852],[-0.9836332371512666,0.1801822820682436],[-0.3866193180590763,0.9222393956579468],[0.20147267138851668,-0.9794941361149513],[-0.8995289706320616,-0.43686111178911724],[0.5731742733637595,0.8194334947718005],[-0.723192413004745,0.6906466055605965],[0.7487559143560304,-0.6628458197174248],[-0.9685944363010195,-0.24864596913424963],[0.5342886844300972,0.8453020771830364],[0.3818166566847001,0.9242380865762446],[-0.42960529676239456,-0.9030167711585954],[-0.9574276828683855,0.2886732271570645],[0.2978812273147811,0.9546029407106599],[0.39686625354554794,0.9178764496361811],[-0.772830212403098,-0.6346128448093235],[-0.4391856987935036,-0.8983963056331331],[-0.8421456287605796,0.5392501645428103],[-0.20531485688762696,-0.9786959740088917],[-0.7619120827441873,-0.6476804599248109],[-0.5756288735301994,0.8177110736429791],[-0.5150890934403439,-0.8571366436098766],[0.8275457569809973,-0.5613982722655532],[0.3982617885985586,-0.9172717960028407],[-0.9648603323617202,0.26276327565858765],[-0.8147092265746267,-0.5798697061704237],[0.18362520292617,-0.9829963300289187],[-0.7873133089175652,-0.6165531230974947],[-0.00031560578593043477,-0.9999999501964927],[-0.9999291393106069,0.011904467965809403],[-0.9999134750680954,-0.013154557280479024],[-0.8363590426929304,0.5481820424874979],[-0.7235798616676992,-0.6902406709177267],[0.9835358743797435,0.18071298738074507],[-0.9928841825216098,-0.11908400437671973],[-0.9961385270070146,-0.08779541566787762],[0.9353895249636097,0.3536190557483471],[0.6513691672872639,-0.7587609688877627],[0.9094176567964739,-0.4158840289152865],[0.02123871749936068,-0.9997744329992553],[-0.00650677405752201,0.999978830721613],[-0.7190072076979913,0.6950026153032358],[-0.6255242956882978,0.7802046882092282],[-0.9653759905001994,-0.2608624100282731],[-0.8666866421832542,-0.4988529485340504],[-0.2133485835466238,-0.9769761419290899],[-0.9646084779288,-0.26368633697611954],[-0.3639529724560892,-0.9314173252846316],[0.29624869247023067,-0.9551108376569071],[0.10944383012321716,-0.9939929818906974],[0.8827846778151699,0.4697778332518114],[0.24660297326136255,0.9691165944191935],[-0.9193203104081332,0.39351005942808326],[-0.9985351566473296,-0.0541067550246074],[-0.11458168353256179,0.9934138300823298],[-0.970392426249881,0.24153372244237295],[-0.1711612962858478,0.9852430211139525],[0.16133661341596595,0.9868994361997919],[0.3102986298953358,0.9506391325235236],[-0.6055584687309901,-0.7958008173834572],[-0.7985053059075148,0.6019877710033205],[-0.7176060770057121,-0.69644922158365],[0.7476817648873604,-0.6640572102273433],[0.8380751112432111,0.5455548624241923],[0.7541208700290244,0.6567356495475689],[-0.848505498411399,0.5291865636669392],[0.9985147572861678,0.05448191885153744],[0.9920966648083873,0.12547592468706611],[0.995088275391773,-0.09899153588982687],[-0.37760460535091983,-0.9259669335444847],[-0.42570595465496786,-0.9048615585664486],[0.9198334594904737,-0.39230907050664415],[0.8103595192934572,-0.5859329735477233],[-0.37461448886346255,-0.9271806645598077],[-0.9916549883779229,0.12892006835703104],[0.7647716432143649,-0.644301430803316],[-0.9554019169582776,-0.29530861327169],[-0.8829609731192511,0.46944639731102966],[0.5760319792345665,0.8174271581609629],[-0.9497288642921654,0.3130736084857899],[-0.6920011528968733,-0.721896394498129],[0.925402029959272,0.37898691659113853],[0.2881509781813012,-0.9575849903654293],[0.47986956336792486,-0.8773398441613587],[0.1688328417077709,-0.9856446984389855],[0.8168635786024356,0.57683090585788],[0.9175353880242778,-0.39765413580539793],[0.9985823047207251,0.053229509660009326],[0.8261382732693985,-0.5634674377809749],[0.6188029732488317,-0.785546230529054],[0.7569620310238657,-0.6534588614352277],[0.930646838074427,-0.36591865596341366],[0.506681393153723,0.8621333805344753],[-0.957386757802686,0.28880892642725076],[0.02415625202017978,0.9997081951691391],[0.8830524271104107,0.46927434510573124],[0.614661148302732,0.7887912732574865],[0.7167099207787375,0.6973714142817554],[0.14413661179796397,-0.9895577987866111],[0.9878658114696233,-0.15530981465916022],[-0.6165723660052728,0.7872982392198397],[-0.9988109016522434,0.04875225882595223],[0.9943916551808787,0.10576027660058636],[-0.5785431570819333,-0.8156517733651227],[0.48431181686093394,-0.8748954589257285],[0.967297987113669,-0.25364267015990066],[-0.6632218468526536,0.7484228629974871],[-0.7900227301344167,-0.6130775529009055],[-0.31168097778296483,-0.9501868069428532],[0.6573051368206626,0.7536245465144895],[0.9925516265957288,-0.12182474519642121],[-0.9782975768107768,0.20720485323988488],[0.999990893250164,-0.004267717977936032],[0.9224976151828886,0.3860027849405794],[0.9868810781706744,-0.1614488697659024],[0.9673491860871724,-0.2534473361005894],[0.530883826385376,0.8474446075599407],[0.49961991326797345,-0.8662447357797348],[0.07524106412228831,0.9971653735814063],[-0.9218018330382338,0.3876614252248374],[0.4381269872515809,-0.8989130898156135],[-0.7900075968514445,-0.6130970534238487],[0.9991422625405036,0.04140940962442339],[0.9143484779885996,-0.4049282168482844],[-0.9947970047036606,-0.10187698185863708],[0.9999570206687831,0.009271289835336429],[-0.45107196642228725,-0.8924875803662093],[0.8799965682499877,0.4749800415472682],[-0.8540468382560338,-0.5201961150036322],[-0.6141841795437257,-0.789162716806997],[0.6130007505932424,0.7900823246802331],[0.5764223085220385,-0.8171519578622595],[-0.9899968813739854,-0.1410892443447869],[0.7009285540406752,-0.7132314926659143],[0.32439352076202926,0.9459222186245626],[0.5039311197313404,-0.8637438431423505],[0.30911175093861865,0.9510257228023128],[0.910337715981347,-0.4138662137235466],[-0.9955112100045483,-0.09464370425590955],[0.9809514087587563,-0.19425327192665592],[0.42947263510394706,-0.9030798722687113],[0.49581131872314044,0.8684302713666886],[-0.9767525903307703,-0.21436972100119553],[-0.8885750302217296,-0.45873131097239533],[0.6610517517849801,0.7503403104338784],[0.4398114040585419,-0.8980901563095177],[0.7186045274071513,0.6954189623456818],[-0.974426720533596,0.22470551019087437],[0.9993021053626661,0.03735374436041219],[0.0205642046845353,0.9997885343839928],[-0.42922387343819035,-0.903198132455286],[-0.5242207491197145,0.8515824130360874],[-0.45644225775330655,-0.8897530361493936],[-0.5814892651150412,-0.813554075987558],[0.36664074783399614,-0.9303625970704799],[0.04616061228022644,-0.9989340307917809],[-0.34489143458577964,-0.9386425828553502],[0.5706958151131056,0.8211615472076053],[-0.36522890332882835,-0.9309177451167323],[0.011067650353468897,0.9999387516821484],[0.05770870359745614,-0.9983334640935868],[-0.7217881378529861,-0.6921140686727287],[-0.9999720436812841,0.007477423077240404],[0.8165483033148766,-0.577277115736971],[-0.8469743817291987,-0.5316337053784698],[-0.7372343726800479,-0.6756370917430868],[0.621509435855839,0.7834066767280943],[-0.7027217829608813,-0.7114647536964006],[0.9536027502476876,0.3010677576892724],[-0.745715663699748,0.666264323608014],[-0.015637976173985692,0.9998777193743152],[-0.8195840636239107,0.5729589537250618],[-0.8892941080024162,0.4573357513601872],[-0.8312688476855009,-0.5558705810416842],[-0.21236746237505802,-0.9771898796673952],[-0.6917352908094928,-0.7221511527711539],[0.6401705971767792,0.7682327814603631],[-0.7130636806048409,-0.7010992707186888],[-0.23020080484294045,-0.9731431495158677],[0.342885182152333,0.9393773213466255],[0.9064956891066723,0.4222150703504309],[-0.26505034886811285,-0.9642345734129697],[0.41104714353606103,0.9116140881923912],[-0.7864523211858189,0.6176509908527935],[0.2945814248437072,0.9556263831315308],[-0.5520760590506364,-0.8337937544879539],[-0.9957317596949792,-0.0922944350150113],[-0.9805073274908799,-0.1964825201810393],[0.5938255087587436,0.8045938510499687],[0.9293648195197582,0.3691626094812518],[-0.025920217000107434,-0.9996640147322836],[0.6302878066882258,0.776361565728331],[-0.20173160312375116,0.9794408406336349],[-0.9966787627431833,-0.08143367790243358],[0.16499682421812611,0.9862940981258749],[0.5596453217521997,-0.8287322328960524],[-0.04087831571462745,0.999164132314774],[-0.5193061024864015,-0.8545883055134694],[0.14687452845028293,0.989155130852844],[0.9838189529100843,0.17916547629190582],[0.05172422012786818,0.99866140660995],[-0.8048671667414636,-0.5934550057936734],[-0.2243001688322283,-0.974520104596018],[-0.7765799613092663,0.6300187010660069],[-0.20125823802746623,0.9795382185632574],[0.45459180059004006,-0.8906998904436361],[0.19792189520387937,0.9802177938595609],[0.9095591207692038,0.415574549058954],[0.5727190654451181,0.8197517136765684],[0.946551039051021,-0.32255407371700096],[0.7523320404813268,0.6587841079330945],[-0.8471452013154445,0.5313614663185647],[0.8036224341109939,-0.595139465498232],[0.007040718975571662,-0.9999752138309764],[-0.6514562070704457,0.7586862396731529],[-0.8254420879206894,0.564486810730891],[0.8837678069636874,0.46792570283603213],[0.3158504470944674,-0.9488089876630728],[0.9570854393795596,-0.28980590354172464],[-0.4852381305697664,0.8743820427256945],[-0.19522413797982563,-0.9807586532628881],[-0.10088386693888765,0.9948982085577683],[0.7871712186876278,-0.6167345234943759],[-0.5317544894769682,-0.8468985552715796],[0.08400229381056044,0.9964655611884258],[-0.8374693793857922,0.5464842528300116],[-0.9985228515857298,-0.05433336784244555],[0.6026841039207596,-0.7979798687192748],[0.2875248928504665,-0.9577731652073614],[-0.8937119954910123,-0.44864113622746726],[-0.5777574480286225,0.8162085096637094],[0.8465190059212946,0.5323585000861949],[0.9689760588651504,-0.24715460211406287],[0.9736954456153398,-0.2278534160111384],[-0.18397241947777698,-0.9829314059849207],[0.8212518686600592,-0.5705658316288849],[-0.21462918007742451,0.9766956102385699],[-0.5674184284701348,0.8234296126764464],[0.907898595284198,-0.4191898623308775],[0.9205054221975402,-0.39072978860707347],[0.9990563385139714,-0.04343308042330262],[0.4681574369863378,0.8836450725231161],[0.21829412970840678,-0.9758830221572918],[-0.4060602582404793,0.9138463036406479],[-0.8015453764684647,0.5979339507521105],[0.8400659614266089,-0.5424842674699306],[-0.9999838134874582,0.005689706765758387],[0.7603826665151938,0.6494753270627327],[-0.8789612533534179,-0.4768931904560902],[0.14243002740505606,0.9898048733429206],[0.11719245514877925,0.9931092228230495],[-0.15191517456865786,-0.9883935348512627],[0.9525062964486295,-0.30451889141023003],[-0.4113200106737045,-0.9114910031478005],[0.13284698140352932,-0.991136559477033],[-0.3937885879298246,-0.9192010378672528],[0.7001977446328197,0.7139489606485275],[-0.6117569054304004,0.7910458195693977],[0.9107373491912307,-0.4129860539874565],[-0.08899658322574029,0.9960319313024778],[-0.48028377771255987,-0.8771131585298173],[0.9612483544718206,0.27568387879093914],[-0.22780673794834294,-0.9737063675181215],[-0.9825137936157037,-0.1861898100189117],[0.5777252944356779,0.8162312688014404],[0.6183596640928918,0.7858952384528908],[0.25001417696809064,0.9682421759637246],[0.37832071887340124,-0.9256745830318087],[-0.9214419837168398,0.3885159850559242],[-0.3385400527835179,0.9409519821230693],[0.9803697768040138,-0.19716769697201433],[0.5292309397422854,0.8484778208176672],[0.6190264036025286,-0.7853701749130275],[0.9975915629052301,0.0693619032344146],[0.9903607699280733,-0.13851189619478135],[0.9999146072358718,0.013068214733934666],[-0.8560961669477474,-0.5168165563692543],[-0.9999949038131027,0.003192545665036052],[0.017613586237418363,-0.9998448687570772],[0.9996585696520582,-0.026129372767080224],[-0.7050284419422647,-0.709179029619787],[0.9161741022001662,-0.4007805065839899],[0.7643682940861033,-0.6447798934488422],[-0.10730612129331599,-0.9942260287947525],[-0.5480126725130728,-0.8364700298068543],[-0.5230482110854393,0.8523030968383969],[-0.8330886942990402,0.5531394285631068],[-0.8256601405027636,-0.5641678228904559],[0.8956254702463324,0.4448089669128039],[-0.8207734759981085,0.571253797447319],[-0.6935430956149369,0.7204151404050657],[0.8438774368771416,-0.536535992762523],[-0.3402373626483902,0.9403395860315931],[0.9042976245301826,0.42690257233831336],[-0.8823430044273517,-0.47060686622499937],[0.459928976116507,-0.8879557066252919],[0.3940855354705983,0.9190737678406733],[-0.0059437550296903546,0.9999823357320603],[0.6148013087566296,-0.7886820339979448],[0.9999560311311009,-0.0093774092657186],[0.9921548559183222,0.12501496661477482],[0.998930126293923,-0.04624502981302068],[0.009699191949638274,0.9999529617314626],[-0.6273135618024974,-0.7787667784251356],[-0.9871820509190155,-0.15959824041425527],[-0.16089856491918342,-0.9869709478028962],[-0.2457810374653758,0.96932537448601],[-0.8515991167114835,0.524193613482863],[0.8914427844041544,-0.4531332719341721],[0.5440989027623595,-0.8390210867509805],[-0.9988377127586775,0.048199829574528695],[0.8667555833416863,0.4987331538468373],[-0.08353923856313253,-0.9965044885098572],[-0.6594562048473932,0.7517429839301947],[0.9423707187645682,0.33457051336773685],[-0.16138031442730108,-0.9868922910405904],[0.35079390743050476,0.936452686743777],[0.21149602968448317,0.9773788566506338],[0.9988394701880408,-0.04816339683280371],[0.5260436959405547,0.850457541539377],[-0.8483060064258889,-0.5295062978490055],[-0.19705153121230778,-0.9803931323947985],[-0.35139351856488643,-0.936227854269776],[0.9821449311337453,-0.1881258468374045],[-0.9493044965880847,0.31435803275507873],[-0.9858593552785179,-0.16757485375146572],[0.9989036577303865,0.0468132734686959],[0.10071180708768165,0.9949156406013193],[-0.4213545004175267,0.9068960166291925],[-0.9916635215697243,-0.12885441392491342],[0.9320857002829183,-0.36223783254665964],[-0.6761475710259318,-0.7367662194995998],[-0.991534238837231,0.1298454974709284],[-0.14693263788054856,-0.9891465007396344],[0.7345797666404907,-0.6785223404151127],[0.7329684605911135,-0.6802626226529672],[0.401385678418175,-0.9159091314976511],[-0.7192484179910054,0.694752987195763],[-0.2038139864096665,0.979009631691027],[-0.7764945447957378,0.6301239734389258],[0.7378710416035169,0.6749417204195789],[-0.6587583940123872,0.7523545562553737],[0.8930580249856234,-0.4499415117643377],[-0.5360559816803233,-0.844182435558064],[-0.9630188716998531,0.26943394877027244],[-0.9991311827462472,-0.04167588828189768],[0.9991558655384156,0.04107987780141991],[-0.8479749383169471,0.5300363232707449],[0.8094089131388574,0.5872454438574841],[-0.9773638498826783,0.21156536801307863],[-0.9933358665749349,0.1152556123398041],[0.33087836901887735,-0.943673410092394],[0.021574208707866787,0.9997672496729574],[0.9779187188641087,-0.20898559590359403],[-0.6662606325311783,-0.7457189614990047],[-0.7058468787100836,-0.7083644427942671],[0.43612001264003286,0.8998885123029727],[-0.884452766570691,-0.4666297286987303],[-0.2792261924965072,-0.9602253555410332],[-0.9259966374508982,0.3775317568491819],[-0.9857305103082865,-0.16833110540647253],[0.5446262504107656,0.8386788702259703],[0.41965800091802236,0.9076823024965779],[-0.9812385484979436,0.19279759060125454],[-0.1385454379907994,-0.9903560781920498],[0.9199770101277924,0.3919723215181497],[-0.8645019082252513,-0.5026295362141973],[-0.8236086470507694,0.5671585285466499],[0.5321170808881113,-0.8466707814889536],[0.8587907627896908,-0.5123264835503832]];
		this.depth = depth;
		this.seed = seed;
		this.scale = scale;
		this.amplification = amplification;
	}

	poll(x, y){
		var val = 0;
		for(var i=0; i<this.depth; i++){
			val += this.getValue(x*this.scale*this.facs[i], y*(this.scale*this.facs[i]), this.seed)/this.facs[i];
		}
		return val;
	}

	getGradients(x, y){
		var xf = Math.floor(x);
		var yf = Math.floor(y);
		var g0raw = ((xf)+32*(yf));
		var g1raw = ((xf+1)+32*(yf));
		var g2raw = ((xf)+32*(yf+1));
		var g3raw = ((xf+1)+32*(yf+1));
		//guards against negative values by shifting
		if(g0raw < 0)
			g0raw = g0raw%1024+1024;
		if(g1raw < 0)
			g1raw = g1raw%1024+1024;
		if(g2raw < 0)
			g2raw = g2raw%1024+1024;
		if(g3raw < 0)
			g3raw = g3raw%1024+1024;
		return [this.gradients[this.pt[(g0raw+this.seed)%1024]], this.gradients[this.pt[(g1raw+this.seed)%1024]], this.gradients[this.pt[(g2raw+this.seed)%1024]], this.gradients[this.pt[(g3raw+this.seed)%1024]]];
	}

	generateWeights(x, y){
		var xf = Math.floor(x);
		var yf = Math.floor(y);
		var g = this.getGradients(x, y);
		var g0 = new Vec2(g[0][0], g[0][1]);
		var g1 = new Vec2(g[1][0], g[1][1]);
		var g2 = new Vec2(g[2][0], g[2][1]);
		var g3 = new Vec2(g[3][0], g[3][1]);
		var v = new Vec2(x, y);
		var w0 = v.sub(new Vec2(xf, yf)).dot(g0);
		var w1 = v.sub(new Vec2(xf+1, yf)).dot(g1);
		var w2 = v.sub(new Vec2(xf, yf+1)).dot(g2);
		var w3 = v.sub(new Vec2(xf+1, yf+1)).dot(g3);
		return [w0, w1, w2, w3];
	}

	intp(a, b){
		return 3*Math.pow((a-b), 2) - 2*Math.pow((a-b), 3);
	}

	getValue(x, y, seed){
		var w = this.generateWeights(x, y, seed);
		var xf = Math.floor(x);
		var yf = Math.floor(y);
		var sx = this.intp(x, xf);
		var a = w[0] + sx * (w[1] - w[0]);
		var b = w[2] + sx * (w[3] - w[2]);
		var sy = this.intp(y, yf);
		var z = a + sy * (b - a);
		return z;
	}
}


exports {Noise2d};
